<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alex Werner</title>
    <style type="text/css">
        html,
        body {
            margin: 0;
            padding: 0;
        }
        a {
            color: black;
            text-decoration: none;
            font-family: monospace;
            font-size: 20px;
            margin-top: 50px;
        }
        .button {
            width: 250px;
            height: 120px;
            background-color: rgba(200,200,210,0.8);
            text-align: center;
            box-shadow: rgba(3, 102, 214, 0.3) 0px 0px 0px 3px;
            -webkit-user-select: none;
            user-select: none;
            text-wrap: wrap;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .button:hover {
            background-color: rgba(200,200,250,0.95);
        }
        #main_div {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            flex-wrap: wrap;
            top: 0;
            left: 0;
            width: 50vw;
            height: 75vh;
        }
        canvas {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 100vw;
            z-index: -1;
        }
        #test {
            position: absolute;
            left: 305px;
            top: 366px;
            width: 100;
            height: 100;
            z-index: 100;
        }

    </style>
</head>
<body style="background-color: rgb(50,50,50); display: flex; flex-direction: column; align-items: center; justify-content: center;">
    <div id="main_div">
        <canvas id="canvas1"></canvas>
        <a href="nightlight/">
            <div class="button" id="a0" onmouseover="hoverelement(this)" onmouseleave="unhover()">
                Nightlight (WebGL)
            </div>
        </a>
        <a href="sunset/" onmouseover="hoverelement(this)" onmouseleave="unhover()">
            <div class="button" id="a1">
                Sunset (WebGL)
            </div>
        </a>
        <a href="bezier/" onmouseover="hoverelement(this)" onmouseleave="unhover()">
            <div class="button" id="a2">
                Bezier Curves (JavaScript)
            </div>
        </a>
        <a href="ducky/" onmouseover="hoverelement(this)" onmouseleave="unhover()">
            <div class="button" id="a2">
                Ducky (WebGL - Might be slow)
            </div>
        </a>
    </div>
    <script>

        var mouseDown = 0;
        document.body.onmousedown = function() { 
            ++mouseDown;
        }
        document.body.onmouseup = function() {
            --mouseDown;
        }

        document.onmousemove = (event) => {
            mouseX = event.pageX;
            mouseY = event.pageY;
        }

        let curr_hover = null;
        function hoverelement(e) {
            curr_hover = e;
        }
        function unhover() {
            curr_hover = null;
        }
 
        canvas1.width = window.innerWidth;
        canvas1.height = window.innerHeight;
        let w = canvas1.width;
        let h = canvas1.height;
        
        let mouseX = w/2;
        let mouseY = h/2;
        let ctx = canvas1.getContext('2d');

        startTime = Date.now();
        let dot_locations = [];
        dot_count = 1000;
        for(let i = 0; i < dot_count; i++) {
            let x = Math.random() * w;
            let y = Math.random() * h;
            dot_locations.push([Math.floor(x), Math.floor(y)]);
        }

        setInterval(() => {
            let td = (Date.now() - startTime) / 1000;
            let s = Math.sin(td);
            let c = Math.cos(td);
            ctx.save();
            ctx.beginPath();
            
            ctx.clearRect(0,0,w,h);
            const vignette = ctx.createRadialGradient(mouseX,mouseY,0,mouseX,mouseY,w*2);
            vignette.addColorStop(0, 'rgb(20,20,20)');
            vignette.addColorStop(1,'rgb(25,25,25)');
            ctx.fillStyle = vignette
            ctx.fillRect(0,0,w*2,h*2);
            
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';

            ctx.globalCompositeOperation = "destination-out";
            for(let i = 0; i < dot_count; i++) {
                // the higher the ratio, the more that
                // x needs to move
                let x = dot_locations[i][0];
                let y = dot_locations[i][1];
                let dx = x - mouseX;
                let dy = y - mouseY;
                if(x > w || y > h || x < 0 || y < 0) {
                    x = Math.random() - 0.5 + mouseX;
                    y = Math.random() - 0.5 + mouseY;
                }
                let angle = Math.atan2(dy, dx);
                x += 3 * Math.cos(angle);
                y += 3 * Math.sin(angle);
                dot_locations[i][0] = x;
                dot_locations[i][1] = y;
                ctx.moveTo(x,y);
                ctx.lineTo(x,y);
            }
            ctx.stroke();
            ctx.closePath();
            ctx.restore();

            
            ctx.globalCompositeOperation = "destination-over";
            let gradient = ctx.createRadialGradient(mouseX,mouseY,0,mouseX,mouseY,w*2);
            if(mouseDown) {
                gradient.addColorStop(0.02, 'rgb(100,100,130)');
            }
            let first_color = 'rgb(100,100,100)';
            if(curr_hover) {
                first_color = 'rgb(200,200,250)';
                gradient.addColorStop(0.1, 'rgb(100,100,100)');
            }
            gradient.addColorStop(0.05, first_color);
            gradient.addColorStop(0.5, 'rgb(35,35,35)');
            ctx.fillStyle = gradient;
            ctx.fillRect(0,0,w,h);
            ctx.restore();
            
        }, 30);
    </script>
</body>
</html>
