<hr color=white size=75><table><tr><td width=75></td><td>
<font face=helvetica>
<center><big><b>

</b></big></center>
<hr color=white size=50>

<table><tr>
<td width=80%>
<font face=helvetica>
<p><b>Introduction to Splines</b><p>
<blockquote>
There are many reasons we might want to create
smooth controllable curves in computer graphics.
Perhaps we might want to create an organic shape,
or animate something along a continuous path.
<p>
As you can see on the right, we can do this
by breaking down our smooth curve into simpler
pieces.
<p>
If we think of the spline curve as a path of motion,
each of these pieces must match its neighbors in both
position and rate, which means that for each
coordinate x and y, we need four values:
a position at both the start and the end,
and a rate (or derivative) at both the start and the end.
<p>
The smallest order polynomial that can
satisfy four constraints is a cubic.
So we describe both the x and y coordinates of
each piece using
<i>parametric cubic</i> polynomials in parameter t:
<blockquote>
x = a<sub>x</sub>t<sup>3</sup> +
    b<sub>x</sub>t<sup>2</sup> +
    c<sub>x</sub>t + d<sub>x</sub>
<p>
y = a<sub>y</sub>t<sup>3</sup> +
    b<sub>y</sub>t<sup>2</sup> +
    c<sub>y</sub>t + d<sub>y</sub>
</blockquote>
where (a<sub>x</sub>, b<sub>x</sub>, c<sub>x</sub>, d<sub>x</sub>)
and (a<sub>y</sub>, b<sub>y</sub>, c<sub>y</sub>, d<sub>y</sub>)
are constant valued polynomial coefficients,
and t varies from t = 0 to t = 1 along
the curve.
</blockquote>
</td>
<td width=50>&nbsp;</td><td width=300>
<img src=imgs/spline.png width=300>
</td>
</tr></table>
<p>&nbsp;<p><hr>&nbsp;<p>

<table><tr>
<td width=80%>
<font face=helvetica>
<p><b>Cubic splines</b><p>
<blockquote>
Although it is technically true that
cubic splines can be designed by tweaking
their polynial coefficients, in practice
that doesn't usually work out very well.
<p>
As you can see in the example on the right,
there is no intuitive connection between
the shape of a cubic polynomial and the values of its
four coefficients --
in this case 7.7, -11.7, 5.0 and -0.6, respectively,
for the
t<sup>3</sup>,
t<sup>2</sup>, t and constant term.
<p>
For that reason, we need a better way to specify cubic spline curves.
Rather than use
t<sup>3</sup>,
t<sup>2</sup>, t and 1 as our four <i>basis functions</i>,
we can use four different basis functions that have
a more intuitive geometric meaning.
<p>
In the following sections we will look at two
different examples of such alternate basis functions.
</blockquote>
</td>
<td width=50>&nbsp;</td><td width=300>
<img src=imgs/cubic.png width=300>
</td>
</tr></table>
<p>&nbsp;<p><hr>&nbsp;<p>

<table><tr>
<td width=80%>
<font face=helvetica>
<p><b>Hermite splines, part 1</b><p>
<blockquote>
We can choose four basis functions
that give us independent control over the position
at t = 0 and t = 1,
as well as the rate of change
at t = 0 and t = 1.
This is called the <i>Hermite</i> basis,
after the french mathematician who devised it.
<p>
If we want a curve with position A at t = 0,
position B at t = 1,
rate C at t = 0,
and rate D at t = 1,
we can use the four functions to the right
to compute the cubic polynomial we are looking for.
<p>
</blockquote>
</td>
<td width=50>&nbsp;</td><td width=200><center>
<b>Position</b><p>
<img src=imgs/hermiteP0.png width=200><br>2t<sup>3</sup> - 3t<sup>2</sup> + 1<p>
<img src=imgs/hermiteP1.png width=200><br>-2t<sup>3</sup> + 3t<sup>2</sup>
</center></td>
<td width=200><center>
<b>Rate</b><p>
<img src=imgs/hermiteR0.png width=200><br>t<sup>3</sup> - 2t<sup>2</sup> + t<p>
<img src=imgs/hermiteR1.png width=200><br>t<sup>3</sup> - t<sup>2</sup>
</center></td>
</tr></table>
<p>&nbsp;<p><hr>&nbsp;<p>

<table><tr>
<td width=80%>
<font face=helvetica>
<p><b>Hermite splines, part 2</b><p>
<blockquote>
Because these four hermite basis polynomials never change,
and the cubic polynomial we want is just a weighted sum of those four polynomials,
we can express this weighted sum as a multiplication of the weights
by a matrix, which we call the <i>Hermite matrix</i>.
<p>
In other words, the expression:
<blockquote>
A (2t<sup>3</sup> - 3t<sup>2</sup> + 1) +
B (-2t<sup>3</sup> + 3t<sup>2</sup>) +
C (t<sup>3</sup> - 3t<sup>2</sup> + t) +
D (t<sup>3</sup> - t<sup>2</sup>)
</blockquote>
can be expressed as a matrix vector product:
<blockquote>
<table><tr>
<td>
a<p>
b<p>
c<p>
d
</td>
<td width=20></td>
<td>
=
</td>
<td width=20></td>
<th><img src=imgs/Hermite.png width=130></th>
<td width=10></td>
<td>
<font size=1><br></font>
A<p>
B<p>
C<p>
D
</td>
</tr></table>
</blockquote>
to convert positions and rates at the two ends into the desired cubic polynomial:
<blockquote>
at<sup>3</sup> + bt<sup>2</sup> + ct + d.
</blockquote>
</blockquote>
</tr></table>
<p>&nbsp;<p><hr>&nbsp;<p>

<table><tr>
<td width=80%>
<font face=helvetica>
<p><b>Bezier splines, part 1</b><p>
<blockquote>
Artists and designers often find it more convenient
to create splines by moving points around, rather
than needing to deal with derivatives.
The <i>Bezier</i> spline enables designers
of spline curves
to work this way.
<p>
Bezier splines work by repeated linear interpolation.
For example, the image to the right shows a simplified
version of a Bezier spline, using three key points
to specify a parametric quadratic spline.
<p>
Note that points along the curve are
found as a linear interpolation of linear interpolations.
We first find points along the edges AB and BC
by linear interpolations (to get the points represented as blue dots):
<blockquote>
<font color=blue>(1-t) A + t B</font>
<p>
<font color=blue>(1-t) B + t C</font>
</blockquote>
and then we interpolate again (to get the point represented as a red dot):
<blockquote>
<font color=red>P = </font>
(1-t) (
<font color=blue>(1-t) A + t B</font>
)
<font color=red>+</font>
t
(
<font color=blue>(1-t) B + t C</font>
)
</blockquote>
If we multiply out all the terms, we get:
<blockquote>
A (1-t)<sup>2</sup> + 2 B (1-t) t + C t<sup>2</sup>
</blockquote>
Note that the weights of the coefficients (1 2 1) follow Pascal's triangle.
</blockquote>
</td>
<td width=50>&nbsp;</td><td width=400>
<img src=imgs/bezier2.png width=400>
</td>
</tr></table>
<p>&nbsp;<p><hr>&nbsp;<p>

<table><tr>
<td width=80%>
<font face=helvetica>
<p><b>Bezier splines, part 2</b><p>
<blockquote>
Now it becomes easier to see what is going on with the full
parametric cubic Bezier spline,
which uses four key points:
The basic set-up is a
linear interpololation of
linear interpolations of
linear interpolations.
<p>
So we start with the points in blue:
<blockquote>
<font color=blue>P = </font>(1-t) A + t B
<p>
<font color=blue>Q = </font>(1-t) B + t C
<p>
<font color=blue>R = </font>(1-t) C + t D
</blockquote>
When the first and second terms are linearly interpolated,
we get the two dots in violet:
<blockquote>
<font color=violet>S = </font>(1-t) <font color=blue>P</font> + t <font color=blue>Q</font>
<p>
<font color=violet>T = </font>(1-t) <font color=blue>Q</font> + t <font color=blue>R</font>
</blockquote>
Finally we linearly interpolate these two points:
(1-t) <font color=violet>S</font> + t <font color=violet>T</font>
<p>
When we multiply everything out, writing the equation in terms of
our original four key points A,B,C and D,
the weights form the next level (1 3 3 1) of Pascal's triangle:
<blockquote>
A (1-t)<sup>3</sup> + 3 B (1-t)<sup>2</sup> t + 3 C (1-t) t<sup>2</sup> + D t<sup>3</sup>
</blockquote>
</blockquote>
</td>
<td width=50>&nbsp;</td><td width=400>
<img src=imgs/bezier3.png width=400>
</td>
</tr></table>
<p>&nbsp;<p><hr>&nbsp;<p>

<table><tr>
<td width=80%>
<font face=helvetica>
<p><b>Bezier splines, part 3</b><p>
<blockquote>
We can multiply out the terms of the above polynomial,
and regroup by powers of t, to get:
<blockquote>
(-A + 3B - 3C + D) t<sup>3</sup> +
(3A - 6B + 3C) t<sup>2</sup> +
(-3A + 3B) t +
D
</blockquote>
<p>
This makes it easy to see that,
as was the case for Hermite splines, the Bezier spline has a characteristic
matrix, which 
can be used to translate the above polynomial until the
standard cubic polynomial, with coefficients, (a,b,c,d):
<blockquote>
<table><tr>
<td>
a<p>
b<p>
c<p>
d
</td>
<td width=20></td>
<td>
=
</td>
<td width=20></td>
<th><img src=imgs/Bezier.png width=130></th>
<td width=10></td>
<td>
A<p>
B<p>
C<p>
D
</td>
</tr></table>
</blockquote>
One powerful property of Bezier splines is that the
direction between A and B determines the direction of the
spline curve at t=0, and the
direction between C and D determines the direction of the
spline curve at t=1.
<p>
This makes it easy to match up splines end-to-end,
so that the resulting composite curve has a continuous derivative.
</blockquote>
</td
</tr></table>
<p>&nbsp;<p><hr>&nbsp;<p>

<table><tr>
<td width=80%>
<font face=helvetica>
<p><b>Bsplines</b><p>
<blockquote>

<table><tr><td>
The last kind of spline we will discuss is the Bspline,
which is a <i>non-interpolating</i> spline.
It produces very smooth splines, which do not pass (interpolate)
through the user's key points, as shown to the right.
<td><img src=imgs/Bspline1.png width=300>
</table>

<table><tr>
<td><img src=imgs/Bspline2.png width=300>
<td>
The influence of each key point extends to
four curved segments of the spline,
as shown to the left.
Because successive segments overlap,
the result is a single smooth curve.
</table>

Each of the four parts of this curve is a cubic polynomial.
Those polynomials are defined by:
<p>
<center>
t<sup>3</sup>
&nbsp; &nbsp; &nbsp; &nbsp;
-3t<sup>3</sup> + 3t<sup>2</sup> + 3t + 1
&nbsp; &nbsp; &nbsp; &nbsp;
3t<sup>3</sup> - 6t<sup>2</sup> + 4
&nbsp; &nbsp; &nbsp; &nbsp;
-t<sup>3</sup> + 3t<sup>2</sup> - 3t + 1
</center>
<p>
<table><tr>
<td valign=top>
The Bspline characteristic matrix is therefore:
<td>
<blockquote>
<table><tr>
<td>
a<p>
b<p>
c<p>
d
</td>
<td width=5></td>
<td>
= &nbsp;<big><big>1/6 *</big></big>
</td>
<th><img src=imgs/Bspline3.png width=130></th>
<td width=10></td>
<td>
A<p>
B<p>
C<p>
D
</td>
</tr></table>
</blockquote>
</blockquote>
</td
</tr></table>
<p>&nbsp;<p><hr>&nbsp;<p>

</font>
</td><td width=75>&nbsp;</td></tr></table>

